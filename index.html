<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenClaw Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,400&family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-base: #080b12;
            --bg-surface: #0e1219;
            --bg-elevated: #141a24;
            --bg-hover: #1a2233;
            --border-subtle: rgba(201, 168, 76, 0.08);
            --border-medium: rgba(201, 168, 76, 0.15);
            --border-strong: rgba(201, 168, 76, 0.3);
            --gold: #c9a84c;
            --gold-bright: #e8c96d;
            --gold-dim: #8a7233;
            --gold-glow: rgba(201, 168, 76, 0.12);
            --text-primary: #e4e2dd;
            --text-secondary: #8a8780;
            --text-dim: #555249;
            --success: #3dd68c;
            --success-dim: rgba(61, 214, 140, 0.12);
            --error: #e85454;
            --error-dim: rgba(232, 84, 84, 0.12);
            --warning: #e8a634;
            --blue: #5b8def;
            --purple: #9b7ae8;
            --font-display: 'Syne', sans-serif;
            --font-body: 'DM Sans', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 14px;
        }

        body {
            font-family: var(--font-body);
            background: var(--bg-base);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        /* === HEADER === */
        header {
            position: relative;
            padding: 2.5rem 3rem 2rem;
            background: linear-gradient(180deg, #0e1219 0%, var(--bg-base) 100%);
            border-bottom: 1px solid var(--border-subtle);
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--gold), var(--gold-bright), var(--gold), transparent);
            opacity: 0.7;
        }

        header::after {
            content: '';
            position: absolute;
            top: -120px; right: -60px;
            width: 400px; height: 400px;
            background: radial-gradient(circle, var(--gold-glow) 0%, transparent 70%);
            pointer-events: none;
        }

        h1 {
            font-family: var(--font-display);
            font-size: 2rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        h1 span.brand-accent {
            background: linear-gradient(135deg, var(--gold-bright), var(--gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-family: var(--font-mono);
            color: var(--text-dim);
            font-size: 0.75rem;
            font-weight: 400;
            letter-spacing: 0.15em;
            text-transform: uppercase;
        }

        .last-update {
            font-family: var(--font-mono);
            color: var(--text-dim);
            font-size: 0.7rem;
            margin-top: 0.75rem;
            letter-spacing: 0.05em;
        }

        /* === CONTAINER === */
        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 1.5rem 2rem;
        }

        /* === QUICK ACTIONS === */
        .quick-actions {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .btn {
            font-family: var(--font-body);
            font-size: 0.8rem;
            font-weight: 500;
            padding: 0.65rem 1.4rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--border-medium);
            background: var(--bg-elevated);
            color: var(--text-secondary);
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent, rgba(201, 168, 76, 0.04));
            opacity: 0;
            transition: opacity 0.25s;
        }

        .btn:hover {
            border-color: var(--border-strong);
            color: var(--text-primary);
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.3);
        }

        .btn:hover::after { opacity: 1; }

        .btn.primary {
            background: linear-gradient(135deg, var(--gold-dim), var(--gold));
            border: 1px solid var(--gold);
            color: #0a0d14;
            font-weight: 600;
        }

        .btn.primary:hover {
            background: linear-gradient(135deg, var(--gold), var(--gold-bright));
            box-shadow: 0 4px 24px rgba(201, 168, 76, 0.25);
        }

        .btn.danger {
            border-color: rgba(232, 84, 84, 0.3);
        }

        .btn.danger:hover {
            background: var(--error-dim);
            border-color: var(--error);
            color: var(--error);
        }

        /* === GRID === */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.25rem;
            margin-bottom: 2rem;
        }

        /* === PANELS === */
        .panel {
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            position: relative;
            overflow: visible;
            animation: panelIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) both;
        }

        .panel::before {
            content: '';
            position: absolute;
            top: 0; left: 24px; right: 24px;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-medium), transparent);
        }

        @keyframes panelIn {
            from { opacity: 0; transform: translateY(12px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .panel:nth-child(1) { animation-delay: 0.05s; }
        .panel:nth-child(2) { animation-delay: 0.1s; }
        .panel:nth-child(3) { animation-delay: 0.15s; }
        .panel:nth-child(4) { animation-delay: 0.2s; }
        .panel:nth-child(5) { animation-delay: 0.25s; }
        .panel:nth-child(6) { animation-delay: 0.3s; }
        .panel:nth-child(7) { animation-delay: 0.35s; }
        .panel:nth-child(8) { animation-delay: 0.4s; }
        .panel:nth-child(9) { animation-delay: 0.45s; }

        .panel-fullwidth { grid-column: 1 / -1; }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.25rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-subtle);
        }

        .panel-title {
            font-family: var(--font-display);
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.01em;
        }

        .panel-badge {
            font-family: var(--font-mono);
            font-size: 0.65rem;
            font-weight: 500;
            background: var(--gold-glow);
            color: var(--gold);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            border: 1px solid rgba(201, 168, 76, 0.12);
            letter-spacing: 0.03em;
        }

        /* === SORT DROPDOWNS === */
        .bot-sort, .session-sort {
            display: inline-block;
            margin-left: 0.75rem;
        }

        .bot-sort select, .session-sort select {
            background: var(--bg-elevated);
            color: var(--text-secondary);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-sm);
            padding: 0.3rem 0.6rem;
            font-family: var(--font-mono);
            font-size: 0.65rem;
            cursor: pointer;
            transition: all 0.2s;
            -webkit-appearance: none;
            appearance: none;
            padding-right: 1.2rem;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='5' viewBox='0 0 8 5'%3E%3Cpath fill='%238a7233' d='M4 5L0 0h8z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.4rem center;
        }

        .bot-sort select:hover, .session-sort select:hover {
            border-color: var(--gold-dim);
            color: var(--text-primary);
        }

        /* === SCROLLABLE CONTENT === */
        .panel-content {
            max-height: 300px;
            overflow-y: auto;
            overflow-x: hidden;
            padding-right: 0.25rem;
        }

        .panel-content::-webkit-scrollbar { width: 4px; }
        .panel-content::-webkit-scrollbar-track { background: transparent; }
        .panel-content::-webkit-scrollbar-thumb {
            background: var(--gold-dim);
            border-radius: 4px;
        }
        .panel-content::-webkit-scrollbar-thumb:hover { background: var(--gold); }

        .panel-fullwidth .panel-content { max-height: 500px; }

        /* === SESSION GRID === */
        .panel-fullwidth .session-list-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
        }

        /* === BOT ITEMS === */
        .bot-item {
            background: var(--bg-elevated);
            padding: 0.9rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: var(--radius-md);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 2px solid transparent;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .bot-item:hover {
            background: var(--bg-hover);
            transform: translateX(2px);
        }

        .bot-item.running { border-left-color: var(--success); }
        .bot-item.idle { border-left-color: var(--text-dim); }
        .bot-item.error { border-left-color: var(--error); }

        .bot-info { flex: 1; }

        .bot-name {
            font-family: var(--font-body);
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 0.15rem;
        }

        .bot-meta {
            font-family: var(--font-mono);
            font-size: 0.65rem;
            color: var(--text-dim);
            letter-spacing: 0.02em;
        }

        .bot-status {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            font-weight: 600;
            padding: 0.25rem 0.7rem;
            border-radius: 20px;
            letter-spacing: 0.08em;
            margin-left: 1rem;
        }

        .status-running {
            background: var(--success-dim);
            color: var(--success);
            border: 1px solid rgba(61, 214, 140, 0.2);
        }

        .status-idle {
            background: rgba(85, 82, 73, 0.15);
            color: var(--text-dim);
            border: 1px solid rgba(85, 82, 73, 0.2);
        }

        .status-error {
            background: var(--error-dim);
            color: var(--error);
            border: 1px solid rgba(232, 84, 84, 0.2);
        }

        /* === TRADING === */
        .position-item {
            background: var(--bg-elevated);
            padding: 0.9rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: var(--radius-md);
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 1rem;
            align-items: center;
            transition: all 0.2s;
        }

        .position-item:hover { background: var(--bg-hover); }

        .position-coin {
            font-family: var(--font-display);
            font-weight: 700;
            font-size: 1rem;
        }

        .position-long { color: var(--success); }
        .position-short { color: var(--error); }

        .stat-box {
            background: var(--bg-elevated);
            padding: 1rem 1.15rem;
            border-radius: var(--radius-md);
            margin-bottom: 0.6rem;
            border: 1px solid var(--border-subtle);
        }

        .stat-label {
            font-family: var(--font-mono);
            font-size: 0.65rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.35rem;
        }

        .stat-value {
            font-family: var(--font-mono);
            font-size: 1.6rem;
            font-weight: 600;
            letter-spacing: -0.02em;
        }

        .stat-positive { color: var(--success); }
        .stat-negative { color: var(--error); }

        /* === CONTENT ENGINE === */
        .channel-stats {
            background: var(--bg-elevated);
            padding: 1rem;
            margin-bottom: 0.6rem;
            border-radius: var(--radius-md);
            border: 1px solid var(--border-subtle);
        }

        .channel-name {
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--gold);
            margin-bottom: 0.75rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 0.75rem;
        }

        .stat-item { text-align: center; }

        .stat-number {
            font-family: var(--font-mono);
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .stat-text {
            font-size: 0.65rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            margin-top: 0.15rem;
        }

        /* === REVENUE === */
        .revenue-stream {
            background: var(--bg-elevated);
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-radius: var(--radius-md);
            border: 1px solid var(--border-subtle);
        }

        .stream-name {
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 0.35rem;
        }

        .stream-amount {
            font-family: var(--font-mono);
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--success);
            margin-bottom: 0.15rem;
        }

        /* === PROGRESS BARS === */
        .progress-bar {
            background: rgba(201, 168, 76, 0.06);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            border-radius: 3px;
            background: linear-gradient(90deg, var(--gold-dim), var(--gold), var(--gold-bright));
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0; right: 0;
            width: 20px; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2));
        }

        /* === MONTHLY TARGET === */
        .monthly-target-box {
            margin-top: 1rem !important;
            padding-top: 1.25rem;
            border-top: 1px solid var(--border-subtle);
        }

        /* === SYSTEM HEALTH === */
        .health-item {
            display: flex;
            justify-content: space-between;
            padding: 0.65rem 0;
            border-bottom: 1px solid var(--border-subtle);
            font-size: 0.85rem;
        }

        .health-item:last-child { border-bottom: none; }

        .health-label { color: var(--text-secondary); }
        .health-value {
            font-family: var(--font-mono);
            font-weight: 500;
            font-size: 0.8rem;
        }

        .error-log {
            background: var(--bg-elevated);
            padding: 0.85rem;
            margin-bottom: 0.4rem;
            border-radius: var(--radius-sm);
            border-left: 2px solid var(--error);
            font-size: 0.8rem;
        }

        .error-time {
            font-family: var(--font-mono);
            color: var(--text-dim);
            font-size: 0.65rem;
        }

        .error-source { color: var(--warning); margin: 0.2rem 0; font-size: 0.75rem; }
        .error-message { color: var(--text-secondary); font-size: 0.75rem; }

        /* === MACHINE HEALTH === */
        .health-metric { margin-bottom: 1rem; }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.4rem;
        }

        .metric-name {
            font-weight: 500;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .metric-value {
            font-family: var(--font-mono);
            color: var(--gold);
            font-weight: 600;
            font-size: 0.8rem;
        }

        /* === CHART === */
        .chart-container {
            height: 200px;
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-dim);
            font-family: var(--font-mono);
            font-size: 0.75rem;
            border: 1px solid var(--border-subtle);
            letter-spacing: 0.05em;
        }

        /* === API USAGE === */
        .api-item {
            background: var(--bg-elevated);
            padding: 0.9rem 1rem;
            margin-bottom: 0.6rem;
            border-radius: var(--radius-md);
            border: 1px solid var(--border-subtle);
        }

        .api-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.4rem;
        }

        .api-name {
            font-weight: 600;
            font-size: 0.85rem;
        }

        .api-usage {
            font-family: var(--font-mono);
            color: var(--gold);
            font-weight: 600;
            font-size: 0.8rem;
        }

        .api-meta {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            color: var(--text-dim);
            margin-top: 0.4rem;
            letter-spacing: 0.03em;
        }

        /* === SESSIONS === */
        .session-item {
            background: var(--bg-elevated);
            padding: 1rem;
            margin-bottom: 0;
            border-radius: var(--radius-md);
            border-left: 2px solid var(--gold-dim);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border-top: 1px solid var(--border-subtle);
            border-right: 1px solid var(--border-subtle);
            border-bottom: 1px solid var(--border-subtle);
        }

        .session-item:hover {
            background: var(--bg-hover);
            border-left-color: var(--gold);
            transform: translateX(2px);
        }

        .session-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.4rem;
        }

        .session-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .session-channel {
            font-family: var(--font-mono);
            font-size: 0.55rem;
            font-weight: 600;
            padding: 0.2rem 0.55rem;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .channel-discord {
            background: rgba(88, 101, 242, 0.15);
            color: #7b8bf5;
            border: 1px solid rgba(88, 101, 242, 0.2);
        }

        .channel-telegram {
            background: rgba(0, 136, 204, 0.12);
            color: #4cb3e0;
            border: 1px solid rgba(0, 136, 204, 0.2);
        }

        .channel-unknown {
            background: rgba(85, 82, 73, 0.15);
            color: var(--text-dim);
            border: 1px solid rgba(85, 82, 73, 0.2);
        }

        .channel-subagent {
            background: rgba(155, 122, 232, 0.12);
            color: #b39af0;
            border: 1px solid rgba(155, 122, 232, 0.2);
        }

        .session-meta {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.15rem;
        }

        .session-tokens {
            font-family: var(--font-mono);
            font-size: 0.7rem;
            color: var(--gold-dim);
            letter-spacing: 0.02em;
        }

        /* === LOADING === */
        .loading {
            display: inline-block;
            width: 10px; height: 10px;
            border: 1.5px solid var(--gold-dim);
            border-top-color: var(--gold);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        /* === MODAL === */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0; top: 0;
            width: 100%; height: 100%;
            background-color: rgba(8, 11, 18, 0.85);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            animation: fadeIn 0.2s;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--bg-surface);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-lg);
            max-width: 500px;
            width: 90%;
            animation: modalIn 0.35s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 24px 80px rgba(0,0,0,0.5);
        }

        @keyframes modalIn {
            from { transform: translateY(-30px) scale(0.97); opacity: 0; }
            to { transform: translateY(0) scale(1); opacity: 1; }
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-family: var(--font-display);
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .modal-close {
            font-size: 1.5rem;
            color: var(--text-dim);
            cursor: pointer;
            transition: color 0.2s;
            line-height: 1;
        }

        .modal-close:hover { color: var(--gold); }

        .modal-body { padding: 1.5rem; }
        .modal-body p { font-size: 0.95rem; color: var(--text-secondary); }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border-subtle);
            text-align: right;
        }

        .modal-footer .btn { min-width: 100px; }

        /* === RESPONSIVE === */
        @media (max-width: 1200px) {
            .dashboard-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            body { font-size: 14px; }
            header { padding: 1.5rem 1.25rem 1.25rem; }
            h1 { font-size: 1.4rem; }
            .container { padding: 0.75rem; }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .panel { padding: 1rem; }
            .panel-title { font-size: 0.9rem; }
            .panel-badge { font-size: 0.6rem; padding: 0.2rem 0.5rem; }

            .panel-content { max-height: 300px; overflow-y: auto; }
            .panel-content.collapsed { max-height: 0; overflow: hidden; }

            .panel-header {
                cursor: pointer;
                user-select: none;
            }

            .panel-header::after {
                content: '‚ñæ';
                margin-left: 0.5rem;
                font-size: 0.7rem;
                color: var(--text-dim);
            }

            .panel-header.collapsed::after { content: '‚ñ∏'; }

            .panel-fullwidth .session-list-grid { grid-template-columns: 1fr; }

            .position-item {
                grid-template-columns: 1fr;
                gap: 0.4rem;
                padding: 0.75rem;
            }

            .position-item > div {
                display: flex;
                justify-content: space-between;
            }

            .bot-item { padding: 0.7rem 0.8rem; font-size: 0.85rem; }
            .bot-meta { font-size: 0.6rem; }
            .session-item { padding: 0.75rem; }
            .session-meta { font-size: 0.7rem; }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }

            .stat-number { font-size: 1.15rem; }

            .quick-actions { flex-direction: column; gap: 0.5rem; }
            .btn { width: 100%; padding: 0.6rem 1rem; font-size: 0.8rem; }
            .chart-container { height: 150px; }

            .api-item { padding: 0.75rem; margin-bottom: 0.5rem; }
            .api-header { font-size: 0.8rem; }
            .stat-box { padding: 0.75rem; margin-bottom: 0.4rem; }
            .stat-label { font-size: 0.6rem; }
            .stat-value { font-size: 1.2rem; }
        }

        @media (max-width: 480px) {
            h1 { font-size: 1.2rem; }
            .subtitle { font-size: 0.65rem; }
            .panel { padding: 0.75rem; }
            .bot-item, .session-item { padding: 0.5rem 0.6rem; }
            .stats-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header>
        <h1><span class="brand-accent">OpenClaw</span> Dashboard</h1>
        <div class="subtitle">Automation Infrastructure Control Center</div>
        <div class="last-update" id="lastUpdate">Last update: <span class="loading"></span></div>
    </header>

    <div class="container">
        <!-- Quick Actions -->
        <div class="quick-actions">
            <button class="btn primary" onclick="refreshDashboard()">üîÑ Refresh All Data</button>
            <button class="btn" onclick="window.open('https://omarkanawati2000-netizen.github.io/omars-terminal/', '_blank')">üìà Trading Terminal</button>
            <button class="btn" onclick="showLogsModal()">üìã View Logs</button>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Bot Status -->
            <div class="panel panel-fullwidth">
                <div class="panel-header">
                    <div class="panel-title">ü§ñ Bot Status</div>
                    <div class="panel-badge" id="activeBots">0 Running / 0 Total</div>
                    <div class="bot-sort">
                        <select id="botSortBy" onchange="sortAndRenderBots()">
                            <option value="status">Sort: Status</option>
                            <option value="lastRun">Sort: Recent</option>
                            <option value="nextRun">Sort: Next Run</option>
                        </select>
                    </div>
                </div>
                <div class="panel-content"><div id="botList"></div></div>
            </div>

            <!-- Trading Dashboard -->
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">üìà Trading Dashboard</div>
                    <div class="panel-badge" id="positionCount">0 Positions</div>
                </div>
                
                <div class="stat-box">
                    <div class="stat-label">Daily P&L</div>
                    <div class="stat-value stat-positive" id="dailyPnl">+$0.00</div>
                </div>

                <div class="stat-box">
                    <div class="stat-label">Win Rate (24h)</div>
                    <div class="stat-value" id="winRate">0%</div>
                </div>

                <div class="panel-content"><div id="positionList"></div></div>
            </div>

            <!-- Content Engine -->
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">üé¨ Content Engine</div>
                    <div class="panel-badge">3 Channels</div>
                </div>

                <div class="panel-content"><div class="channel-stats">
                    <div class="channel-name">Arc Highlightz</div>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-number" id="arcClipsToday">0</div>
                            <div class="stat-text">Clips Today</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="arcViews">0</div>
                            <div class="stat-text">Views (7d)</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="arcSubs">0</div>
                            <div class="stat-text">Subscribers</div>
                        </div>
                    </div>
                </div>

                <div class="channel-stats">
                    <div class="channel-name">FomoHighlights</div>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-number" id="rageClipsToday">0</div>
                            <div class="stat-text">Clips Today</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="rageViews">0</div>
                            <div class="stat-text">Views (7d)</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="rageSubs">0</div>
                            <div class="stat-text">Subscribers</div>
                        </div>
                    </div>
                </div>

                <div class="channel-stats">
                    <div class="channel-name">Viral Moments</div>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-number" id="viralClipsToday">0</div>
                            <div class="stat-text">Clips Today</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="viralViews">0</div>
                            <div class="stat-text">Views (7d)</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="viralSubs">0</div>
                            <div class="stat-text">Subscribers</div>
                        </div>
                    </div>
                </div>

                </div><div class="stat-box">
                    <div class="stat-label">YouTube API Quota</div>
                    <div class="stat-value">
                        <span id="ytQuotaUsed">0</span> / 10,000
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="ytQuotaBar" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- Revenue Tracker -->
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">üí∞ Revenue Tracker</div>
                    <div class="panel-badge" id="totalRevenue">$0/mo</div>
                </div>

                <div class="panel-content"><div class="revenue-stream">
                    <div class="stream-name">OpenClaw Business</div>
                    <div class="stream-amount" id="openclawRevenue">$0 MRR</div>
                    <div class="stat-text" id="openclawClients">0 clients this month</div>
                </div>

                <div class="revenue-stream">
                    <div class="stream-name">Trading P&L</div>
                    <div class="stream-amount" id="tradingRevenue">$0</div>
                    <div class="stat-text">Monthly performance</div>
                </div>

                <div class="revenue-stream">
                    <div class="stream-name">Content Monetization</div>
                    <div class="stream-amount" id="contentRevenue">$0</div>
                    <div class="stat-text">Ad revenue estimate</div>
                </div>

                </div><div class="stat-box monthly-target-box">
                    <div class="stat-label">Monthly Target: $10,000</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="revenueProgress" style="width: 0%"></div>
                    </div>
                    <div class="stat-text" style="margin-top: 0.5rem" id="revenuePercent">0% achieved</div>
                </div>
            </div>

            <!-- System Health -->
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">‚öôÔ∏è System Health</div>
                    <div class="panel-badge">All Systems Operational</div>
                </div>

                <div class="panel-content"><div class="health-item">
                    <span class="health-label">OpenAI API Usage</span>
                    <span class="health-value" id="openaiUsage">0%</span>
                </div>

                <div class="health-item">
                    <span class="health-label">Hyperliquid Rate Limit</span>
                    <span class="health-value" id="hyperliquidRate">Good</span>
                </div>

                <div class="health-item">
                    <span class="health-label">Workspace Size</span>
                    <span class="health-value" id="workspaceSize">0 MB</span>
                </div>

                <div class="health-item">
                    <span class="health-label">Data Folder</span>
                    <span class="health-value" id="dataSize">0 MB</span>
                </div>

                </div><div style="margin-top: 1.5rem; margin-bottom: 0.5rem;">
                    <strong style="font-size: 0.85rem;">Recent Errors (0)</strong>
                </div>
                <div id="errorLog">
                    <div style="color: var(--text-dim); text-align: center; padding: 2rem; font-size: 0.8rem;">
                        No recent errors
                    </div>
                </div>
            </div>

            <!-- Machine Health -->
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">üíª Machine Health</div>
                    <div class="panel-badge" id="machineStatus">Good</div>
                </div>
                
                <div class="panel-content">
                    <div class="health-metric">
                        <div class="metric-header">
                            <span class="metric-name">CPU Usage</span>
                            <span class="metric-value" id="cpuUsage">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="cpuBar" style="width: 0%"></div>
                        </div>
                    </div>

                    <div class="health-metric">
                        <div class="metric-header">
                            <span class="metric-name">Memory (RAM)</span>
                            <span class="metric-value" id="memUsage">0 GB / 0 GB</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="memBar" style="width: 0%"></div>
                        </div>
                    </div>

                    <div class="health-metric">
                        <div class="metric-header">
                            <span class="metric-name">Disk (C:)</span>
                            <span class="metric-value" id="diskUsage">0 GB / 0 GB</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="diskBar" style="width: 0%"></div>
                        </div>
                    </div>

                    <div class="health-metric">
                        <div class="metric-header">
                            <span class="metric-name">Network</span>
                            <span class="metric-value" id="netUsage">0 KB/s</span>
                        </div>
                    </div>

                    <div class="health-metric">
                        <div class="metric-header">
                            <span class="metric-name">Python Processes</span>
                            <span class="metric-value" id="pythonProcs">0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Performance Chart -->
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">üìä Performance Chart</div>
                    <div class="panel-badge">7 Days</div>
                </div>
                <div class="chart-container">
                    Chart: Cumulative P&L (coming soon)
                </div>
            </div>
        
            <!-- API Usage Tracker -->
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">üîå API Usage</div>
                    <div class="panel-badge">All APIs</div>
                </div>
                
                <div class="panel-content"><div class="api-item">
                    <div class="api-header">
                        <span class="api-name">OpenAI API</span>
                        <span class="api-usage" id="openaiApiUsage">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="openaiApiBar" style="width: 0%"></div>
                    </div>
                    <div class="api-meta" id="openaiApiMeta">Unknown usage</div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="api-name">YouTube Data API</span>
                        <span class="api-usage" id="ytApiUsage">0 / 10,000</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="ytApiBar" style="width: 0%"></div>
                    </div>
                    <div class="api-meta" id="ytApiMeta">Daily quota</div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="api-name">Hyperliquid API</span>
                        <span class="api-usage" id="hlApiUsage">Good</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="hlApiBar" style="width: 0%"></div>
                    </div>
                    <div class="api-meta" id="hlApiMeta">Rate limit status</div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="api-name">Twitch API</span>
                        <span class="api-usage" id="twitchApiUsage">Unknown</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="twitchApiBar" style="width: 0%"></div>
                    </div>
                    <div class="api-meta" id="twitchApiMeta">Helix API calls</div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="api-name">Anthropic API</span>
                        <span class="api-usage" id="anthropicApiUsage">0 tokens</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="anthropicApiBar" style="width: 0%"></div>
                    </div>
                    <div class="api-meta" id="anthropicApiMeta">Total session tokens</div>
                </div>
            </div>

            </div>

            <!-- Sessions Tracker -->
            <div class="panel panel-fullwidth">
                <div class="panel-header">
                    <div class="panel-title">üí¨ Active Sessions</div>
                    <div class="panel-badge" id="sessionCount">0 Sessions</div>
                    <div class="session-sort">
                        <select id="sessionSortBy" onchange="sortAndRenderSessions()">
                            <option value="lastActive">Sort: Recent</option>
                            <option value="tokens">Sort: Tokens</option>
                        </select>
                    </div>
                </div>
                <div class="panel-content"><div id="sessionList"></div></div>
            </div>
        </div>
    </div>

    <script>
// Fetch real data from data.json
        let dashboardData = null;
        
        async function loadData() {
            console.log('[DEBUG] Attempting to load data.json...');
            try {
                // Cache-bust with timestamp to force fresh data
                const timestamp = new Date().getTime();
                const response = await fetch(`data.json?t=${timestamp}`);
                console.log('[DEBUG] Fetch response:', response.status, response.statusText);
                
                if (response.ok) {
                    dashboardData = await response.json();
                    console.log('[OK] Loaded real data:', {
                        positions: dashboardData.positions?.length || 0,
                        sessions: dashboardData.sessions?.length || 0,
                        bots: dashboardData.bots?.length || 0,
                        anthropicTokens: dashboardData.stats?.anthropicTokens || 0,
                        ytQuota: dashboardData.stats?.ytQuotaUsed || 0
                    });
                    return true;
                } else {
                    console.warn('[WARN] data.json fetch failed:', response.status);
                    return false;
                }
            } catch (e) {
                console.error('[ERROR] Failed to load data.json:', e.message);
                return false;
            }
        }

        // Mock data generator (fallback)
        const mockData = {
            bots: [
                { name: 'RSI Bot', status: 'running', interval: '30 min', lastRun: '2 min ago', nextRun: '28 min', errors: 0 },
                { name: 'SMC Bot', status: 'running', interval: 'Hourly', lastRun: '15 min ago', nextRun: '45 min', errors: 0 },
                { name: 'Arc Highlightz Clipper', status: 'idle', interval: '30 min', lastRun: '5 min ago', nextRun: '25 min', errors: 0 },
                { name: 'FomoHighlights Clipper', status: 'running', interval: '30 min', lastRun: '1 min ago', nextRun: '29 min', errors: 0 },
                { name: 'Content Health Monitor', status: 'idle', interval: 'Hourly', lastRun: '42 min ago', nextRun: '18 min', errors: 0 },
                { name: 'Data Collector', status: 'idle', interval: 'Daily', lastRun: '3 hours ago', nextRun: '21 hours', errors: 0 },
                { name: 'Morning Market Briefing', status: 'idle', interval: 'Daily 9AM', lastRun: 'Yesterday', nextRun: '4 hours', errors: 0 },
                { name: 'Idea Generator', status: 'idle', interval: 'Weekly', lastRun: '2 days ago', nextRun: '5 days', errors: 0 },
                { name: 'Security Scan', status: 'idle', interval: 'Daily', lastRun: '18 hours ago', nextRun: '6 hours', errors: 0 },
            ],
            positions: [
                { coin: 'BTC', direction: 'LONG', size: '0.01364', entry: 67637, pnl: 125.45, pnlPercent: 2.8 },
                { coin: 'ETH', direction: 'SHORT', size: '0.0049', entry: 1981, pnl: -15.23, pnlPercent: -0.9 },
                { coin: 'SOL', direction: 'LONG', size: '20.4', entry: 0.94504, pnl: 8.92, pnlPercent: 1.2 },
                { coin: 'DOGE', direction: 'LONG', size: '4309', entry: 0.097235, pnl: 42.18, pnlPercent: 1.5 },
            ],
            sessions: [
                { name: 'Discord #general', channel: 'discord', kind: 'group', model: 'claude-sonnet-4-5', tokens: 89000, lastActive: '2 min ago', sessionKey: 'agent:main:discord:channel:1468193294906425430' },
                { name: 'Telegram Retards v2', channel: 'telegram', kind: 'group', model: 'claude-sonnet-4-5', tokens: 45000, lastActive: '1 hour ago', sessionKey: 'agent:main:telegram:-1003146730450' },
            ],
            stats: {
                dailyPnl: 161.32,
                winRate: 75,
                positionCount: 4,
                arcClipsToday: 3,
                arcViews: 2847,
                arcSubs: 42,
                rageClipsToday: 2,
                rageViews: 1923,
                rageSubs: 38,
                viralClipsToday: 0,
                viralViews: 0,
                viralSubs: 0,
                ytQuotaUsed: 3420,
                openclawRevenue: 0,
                openclawClients: 0,
                tradingRevenue: 850,
                contentRevenue: 0,
                totalRevenue: 850,
                monthlyTarget: 10000,
            }
        };

        function renderBots() {
            const data = dashboardData || mockData;
            const botList = document.getElementById('botList');
            
            const sortedBots = sortBots(data.bots || [], currentBotSort);
            botList.innerHTML = sortedBots.map(bot => `
                <div class="bot-item ${bot.status}">
                    <div class="bot-info">
                        <div class="bot-name">${bot.name}</div>
                        <div class="bot-meta">
                            ${bot.interval} ‚Ä¢ Last: ${bot.lastRun} ‚Ä¢ Next: ${bot.nextRun} ‚Ä¢ Errors: ${bot.errors}
                        </div>
                    </div>
                    <div class="bot-status status-${bot.status}">${bot.status.toUpperCase()}</div>
                </div>
            `).join('');

            const runningCount = sortedBots.filter(b => b.status === 'running').length;
            const totalBots = sortedBots.length;
            document.getElementById('activeBots').textContent = `${runningCount} Running / ${totalBots} Total`;
        }

        function renderPositions() {
            const data = dashboardData || mockData;
            const positionList = document.getElementById('positionList');
            if (data.positions.length === 0) {
                positionList.innerHTML = '<div style="color: var(--text-dim); text-align: center; padding: 2rem;">No open positions</div>';
                return;
            }

            positionList.innerHTML = data.positions.map(pos => `
                <div class="position-item">
                    <div>
                        <div class="position-coin position-${pos.direction.toLowerCase()}">${pos.coin} ${pos.direction}</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); font-family: var(--font-mono);">Size: ${pos.size}</div>
                    </div>
                    <div>
                        <div style="font-size: 0.65rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.08em;">Entry</div>
                        <div style="font-family: var(--font-mono); font-weight: 500;">$${pos.entry.toFixed(2)}</div>
                    </div>
                    <div>
                        <div style="font-size: 0.65rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.08em;">P&L</div>
                        <div class="${pos.pnl >= 0 ? 'position-long' : 'position-short'}" style="font-family: var(--font-mono); font-weight: 600;">
                            ${pos.pnl >= 0 ? '+' : ''}$${pos.pnl.toFixed(2)}
                        </div>
                    </div>
                    <div>
                        <div style="font-size: 0.65rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.08em;">%</div>
                        <div class="${pos.pnlPercent >= 0 ? 'position-long' : 'position-short'}" style="font-family: var(--font-mono); font-weight: 600;">
                            ${pos.pnlPercent >= 0 ? '+' : ''}${pos.pnlPercent.toFixed(2)}%
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderStats() {
            const data = dashboardData || mockData;
            const { stats } = data;

            document.getElementById('dailyPnl').textContent = `${stats.dailyPnl >= 0 ? '+' : ''}$${stats.dailyPnl.toFixed(2)}`;
            document.getElementById('dailyPnl').className = `stat-value ${stats.dailyPnl >= 0 ? 'stat-positive' : 'stat-negative'}`;
            
            document.getElementById('winRate').textContent = `${stats.winRate}%`;
            document.getElementById('positionCount').textContent = `${stats.positionCount} Positions`;

            document.getElementById('arcClipsToday').textContent = stats.arcClipsToday;
            document.getElementById('arcViews').textContent = stats.arcViews.toLocaleString();
            document.getElementById('arcSubs').textContent = stats.arcSubs;

            document.getElementById('rageClipsToday').textContent = stats.rageClipsToday;
            document.getElementById('rageViews').textContent = stats.rageViews.toLocaleString();
            document.getElementById('rageSubs').textContent = stats.rageSubs;

            document.getElementById('viralClipsToday').textContent = stats.viralClipsToday;
            document.getElementById('viralViews').textContent = stats.viralViews.toLocaleString();
            document.getElementById('viralSubs').textContent = stats.viralSubs;

            document.getElementById('ytQuotaUsed').textContent = stats.ytQuotaUsed.toLocaleString();
            const quotaPercent = (stats.ytQuotaUsed / 10000) * 100;
            document.getElementById('ytQuotaBar').style.width = `${quotaPercent}%`;

            document.getElementById('openclawRevenue').textContent = `$${stats.openclawRevenue} MRR`;
            document.getElementById('openclawClients').textContent = `${stats.openclawClients} clients this month`;
            document.getElementById('tradingRevenue').textContent = `$${stats.tradingRevenue}`;
            document.getElementById('contentRevenue').textContent = `$${stats.contentRevenue}`;
            document.getElementById('totalRevenue').textContent = `$${stats.totalRevenue}/mo`;

            const revenuePercent = (stats.totalRevenue / stats.monthlyTarget) * 100;
            document.getElementById('revenueProgress').style.width = `${revenuePercent}%`;
            document.getElementById('revenuePercent').textContent = `${revenuePercent.toFixed(1)}% achieved`;

            document.getElementById('openaiUsage').textContent = '15%';
            document.getElementById('hyperliquidRate').textContent = 'Good';
            document.getElementById('workspaceSize').textContent = '245 MB';
            document.getElementById('dataSize').textContent = '3.1 MB';
        }

        function renderMachineHealth() {
            const data = dashboardData || mockData;
            const machine = data.machine || {};
            
            const cpuPercent = machine.cpuPercent || 0;
            document.getElementById('cpuUsage').textContent = `${cpuPercent.toFixed(1)}%`;
            document.getElementById('cpuBar').style.width = `${cpuPercent}%`;
            
            const memUsed = machine.memUsedGB || 0;
            const memTotal = machine.memTotalGB || 0;
            const memPercent = machine.memPercent || 0;
            document.getElementById('memUsage').textContent = `${memUsed.toFixed(1)} GB / ${memTotal.toFixed(1)} GB`;
            document.getElementById('memBar').style.width = `${memPercent}%`;
            
            const diskUsed = machine.diskUsedGB || 0;
            const diskTotal = machine.diskTotalGB || 0;
            const diskPercent = machine.diskPercent || 0;
            document.getElementById('diskUsage').textContent = `${diskUsed.toFixed(0)} GB / ${diskTotal.toFixed(0)} GB`;
            document.getElementById('diskBar').style.width = `${diskPercent}%`;
            
            const netSpeed = machine.netSpeed || 0;
            let netDisplay = netSpeed < 1024 ? `${netSpeed.toFixed(0)} KB/s` : `${(netSpeed/1024).toFixed(1)} MB/s`;
            document.getElementById('netUsage').textContent = netDisplay;
            
            const pythonProcs = machine.pythonProcesses || 0;
            document.getElementById('pythonProcs').textContent = pythonProcs;
            
            const status = (cpuPercent > 80 || memPercent > 90 || diskPercent > 90) ? 'Warning' : 'Good';
            document.getElementById('machineStatus').textContent = status;
        }

        function renderApiUsage() {
            const data = dashboardData || mockData;
            const stats = data.stats || {};
            
            const ytUsed = stats.ytQuotaUsed || 0;
            const ytPercent = (ytUsed / 10000) * 100;
            document.getElementById('ytApiUsage').textContent = `${ytUsed.toLocaleString()} / 10,000`;
            document.getElementById('ytApiBar').style.width = `${ytPercent}%`;
            const ytRemaining = 10000 - ytUsed;
            document.getElementById('ytApiMeta').textContent = `${ytRemaining.toLocaleString()} units remaining`;
            
            const openaiUsed = stats.openaiUsage || 0;
            document.getElementById('openaiApiUsage').textContent = `${openaiUsed}%`;
            document.getElementById('openaiApiBar').style.width = `${openaiUsed}%`;
            document.getElementById('openaiApiMeta').textContent = openaiUsed > 0 ? `${100 - openaiUsed}% remaining` : 'Unknown usage';
            
            const hlStatus = stats.hyperliquidRate || 'Unknown';
            document.getElementById('hlApiUsage').textContent = hlStatus;
            const hlPercent = hlStatus === 'Good' ? 25 : hlStatus === 'Warning' ? 75 : hlStatus === 'Throttled' ? 100 : 0;
            document.getElementById('hlApiBar').style.width = `${hlPercent}%`;
            document.getElementById('hlApiMeta').textContent = hlStatus === 'Good' ? 'No rate limit issues' : 'Rate limit status';
            
            const twitchStatus = stats.twitchUsage || 'Unknown';
            document.getElementById('twitchApiUsage').textContent = twitchStatus;
            document.getElementById('twitchApiBar').style.width = '0%';
            document.getElementById('twitchApiMeta').textContent = 'Tracking not enabled';
            
            const anthropicTokens = stats.anthropicTokens || 0;
            const anthropicPercent = stats.anthropicPercent || 0;
            
            if (anthropicTokens > 0) {
                let tokenDisplay;
                if (anthropicTokens >= 1000000) {
                    tokenDisplay = (anthropicTokens / 1000000).toFixed(1) + 'M';
                } else if (anthropicTokens >= 1000) {
                    tokenDisplay = (anthropicTokens / 1000).toFixed(1) + 'K';
                } else {
                    tokenDisplay = anthropicTokens.toLocaleString();
                }
                
                document.getElementById('anthropicApiUsage').textContent = `${tokenDisplay} tokens`;
                document.getElementById('anthropicApiBar').style.width = `${Math.min(anthropicPercent, 100)}%`;
                
                const sessions = data.sessions || [];
                document.getElementById('anthropicApiMeta').textContent = `Across ${sessions.length} sessions`;
            } else {
                document.getElementById('anthropicApiUsage').textContent = '0 tokens';
                document.getElementById('anthropicApiBar').style.width = '0%';
                document.getElementById('anthropicApiMeta').textContent = 'No sessions active';
            }
        }

        let currentBotSort = 'status';
        
        function sortAndRenderBots() {
            currentBotSort = document.getElementById('botSortBy').value;
            renderBots();
        }
        
        function sortBots(bots, sortBy) {
            const sorted = [...bots];
            
            if (sortBy === 'lastRun') {
                sorted.sort((a, b) => parseTimeAgo(a.lastRun) - parseTimeAgo(b.lastRun));
            } else if (sortBy === 'nextRun') {
                sorted.sort((a, b) => parseTimeNext(a.nextRun) - parseTimeNext(b.nextRun));
            } else {
                const statusOrder = { 'running': 0, 'ok': 1, 'idle': 2, 'error': 3 };
                sorted.sort((a, b) => (statusOrder[a.status] || 4) - (statusOrder[b.status] || 4));
            }
            
            return sorted;
        }
        
        function parseTimeAgo(timeStr) {
            if (!timeStr || timeStr === 'Unknown') return 999999;
            const match = timeStr.match(/(\d+)\s*(min|hour|day|week)/i);
            if (!match) return 999999;
            const value = parseInt(match[1]);
            const unit = match[2].toLowerCase();
            if (unit.startsWith('min')) return value;
            if (unit.startsWith('hour')) return value * 60;
            if (unit.startsWith('day')) return value * 1440;
            if (unit.startsWith('week')) return value * 10080;
            return 999999;
        }
        
        function parseTimeNext(timeStr) {
            if (!timeStr || timeStr === 'Unknown') return 999999;
            const match = timeStr.match(/(\d+)(m|h|d)/);
            if (!match) return 999999;
            const value = parseInt(match[1]);
            const unit = match[2];
            if (unit === 'm') return value;
            if (unit === 'h') return value * 60;
            if (unit === 'd') return value * 1440;
            return 999999;
        }

        let currentSessionSort = 'lastActive';
        
        function sortAndRenderSessions() {
            currentSessionSort = document.getElementById('sessionSortBy').value;
            renderSessions();
        }
        
        function sortSessions(sessions, sortBy) {
            const sorted = [...sessions];
            if (sortBy === 'tokens') {
                sorted.sort((a, b) => (b.tokens || 0) - (a.tokens || 0));
            }
            return sorted;
        }

        function renderSessions() {
            const data = dashboardData || mockData;
            const sessionList = document.getElementById('sessionList');
            const sortedSessions = sortSessions(data.sessions || [], currentSessionSort);
            
            if (!sortedSessions || sortedSessions.length === 0) {
                sessionList.innerHTML = '<div style="color: var(--text-dim); text-align: center; padding: 2rem;">No active sessions</div>';
                return;
            }
            
            const sessionHTML = sortedSessions.map(session => `
                <div class="session-item">
                    <div class="session-header">
                        <div class="session-name">${session.name}</div>
                        <div class="session-channel channel-${session.channel}">${session.channel}</div>
                    </div>
                    <div class="session-meta">
                        Model: ${session.model} ‚Ä¢ Kind: ${session.kind}
                    </div>
                    <div class="session-meta">
                        Last active: ${session.lastActive}
                    </div>
                    <div class="session-tokens">
                        ${(session.tokens || 0).toLocaleString()} tokens used
                    </div>
                </div>
            `).join('');
            sessionList.innerHTML = `<div class="session-list-grid">${sessionHTML}</div>`;
            
            document.getElementById('sessionCount').textContent = `${sortedSessions.length} Active`;
        }

        async function refreshDashboard() {
            // Force reload data from server (cache-bust with timestamp)
            await loadData();
            const now = new Date();
            document.getElementById('lastUpdate').innerHTML = `Last update: ${now.toLocaleTimeString()}`;
            renderBots();
            renderPositions();
            renderStats();
            renderApiUsage();
            renderMachineHealth();
            renderSessions();
        }

        setInterval(refreshDashboard, 10000);

        function showLogsModal() {
            document.getElementById('logsModal').classList.add('show');
        }

        function closeLogsModal() {
            document.getElementById('logsModal').classList.remove('show');
        }

        window.onclick = function(event) {
            const modal = document.getElementById('logsModal');
            if (event.target == modal) {
                closeLogsModal();
            }
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeLogsModal();
            }
        });

        let collapsedPanels = new Set();
        
        function initMobileCollapse() {
            if (window.innerWidth <= 768) {
                document.querySelectorAll('.panel-header').forEach(header => {
                    header.onclick = function() {
                        const panel = this.closest('.panel');
                        const content = panel.querySelector('.panel-content') || 
                                       panel.querySelector('#botList')?.parentElement ||
                                       panel.querySelector('#positionList')?.parentElement ||
                                       panel.querySelector('#sessionList')?.parentElement;
                        
                        if (content) {
                            this.classList.toggle('collapsed');
                            content.classList.toggle('collapsed');
                        }
                    };
                });
            }
        }

        let resizeTimer;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(initMobileCollapse, 250);
        });

        (async function() {
            await loadData();
            refreshDashboard();
            initMobileCollapse();
        })();
    </script>

    <!-- Logs Viewer Modal -->
    <div id="logsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìã Logs Viewer</h2>
                <span class="modal-close" onclick="closeLogsModal()">&times;</span>
            </div>
            <div class="modal-body">
                <p>Logs viewer coming soon</p>
                <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 1rem;">
                    This feature will allow you to view and filter logs from all your bots, trading systems, and automation tasks.
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn primary" onclick="closeLogsModal()">OK</button>
            </div>
        </div>
    </div>

</body>
</html>
